(function(){'use strict';var me=Math.round,pe=Math.sin,ye=Math.cos,he=Math.PI,ge=Math.sqrt;function e(e,t){return t={exports:{}},e(t,t.exports),t.exports}function t(e,t,r){var o=new Ee(3);return e&&(o[0]=e),t&&(o[1]=t),r&&(o[2]=r),o}function r(e,t,r){return r=r||new Ee(3),r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],r}function o(e,t,r){return r=r||new Ee(3),r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r}function a(e,t,r){r=r||new Ee(3);var o=e[2]*t[0]-e[0]*t[2],a=e[0]*t[1]-e[1]*t[0];return r[0]=e[1]*t[2]-e[2]*t[1],r[1]=o,r[2]=a,r}function n(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function s(e){return ge(e[0]*e[0]+e[1]*e[1]+e[2]*e[2])}function l(e,t){t=t||new Ee(3);var r=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],o=ge(r);return 1e-5<o?(t[0]=e[0]/o,t[1]=e[1]/o,t[2]=e[2]/o):(t[0]=0,t[1]=0,t[2]=0),t}function d(e,t){return t=t||new Ee(3),t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function c(e){return e=e||new Le(16),e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function u(e,t){t=t||new Le(16);var r=e[0],o=e[1],a=e[2],n=e[3],i=e[4],s=e[5],l=e[6],c=e[7],u=e[8],f=e[9],m=e[10],p=e[11],y=e[12],h=e[13],g=e[14],v=e[15],x=m*v,b=g*p,_=l*v,T=g*c,E=l*p,L=m*c,S=a*v,A=g*n,w=a*p,z=m*n,P=a*c,M=l*n,D=u*h,R=y*f,O=i*h,C=y*s,B=i*f,F=u*s,G=r*h,H=y*o,I=r*f,N=u*o,k=r*s,V=i*o,X=x*s+T*f+E*h-(b*s+_*f+L*h),U=b*o+S*f+z*h-(x*o+A*f+w*h),W=_*o+A*s+P*h-(T*o+S*s+M*h),Y=L*o+w*s+M*f-(E*o+z*s+P*f),j=1/(r*X+i*U+u*W+y*Y);return t[0]=j*X,t[1]=j*U,t[2]=j*W,t[3]=j*Y,t[4]=j*(b*i+_*u+L*y-(x*i+T*u+E*y)),t[5]=j*(x*r+A*u+w*y-(b*r+S*u+z*y)),t[6]=j*(T*r+S*i+M*y-(_*r+A*i+P*y)),t[7]=j*(E*r+z*i+P*u-(L*r+w*i+M*u)),t[8]=j*(D*c+C*p+B*v-(R*c+O*p+F*v)),t[9]=j*(R*n+G*p+N*v-(D*n+H*p+I*v)),t[10]=j*(O*n+H*c+k*v-(C*n+G*c+V*v)),t[11]=j*(F*n+I*c+V*p-(B*n+N*c+k*p)),t[12]=j*(O*m+F*g+R*l-(B*g+D*l+C*m)),t[13]=j*(I*g+D*a+H*m-(G*m+N*g+R*a)),t[14]=j*(G*l+V*g+C*a-(k*g+O*a+H*l)),t[15]=j*(k*m+B*a+N*l-(I*l+V*m+F*a)),t}function f(e,t,r){r=r||new Le(16);var o=e[0],a=e[1],n=e[2],i=e[3],s=e[4],l=e[5],d=e[6],c=e[7],u=e[8],f=e[9],m=e[10],p=e[11],y=e[12],h=e[13],g=e[14],v=e[15],x=t[0],b=t[1],_=t[2],T=t[3],E=t[4],L=t[5],S=t[6],A=t[7],w=t[8],z=t[9],P=t[10],M=t[11],D=t[12],R=t[13],O=t[14],C=t[15];return r[0]=o*x+s*b+u*_+y*T,r[1]=a*x+l*b+f*_+h*T,r[2]=n*x+d*b+m*_+g*T,r[3]=i*x+c*b+p*_+v*T,r[4]=o*E+s*L+u*S+y*A,r[5]=a*E+l*L+f*S+h*A,r[6]=n*E+d*L+m*S+g*A,r[7]=i*E+c*L+p*S+v*A,r[8]=o*w+s*z+u*P+y*M,r[9]=a*w+l*z+f*P+h*M,r[10]=n*w+d*z+m*P+g*M,r[11]=i*w+c*z+p*P+v*M,r[12]=o*D+s*R+u*O+y*C,r[13]=a*D+l*R+f*O+h*C,r[14]=n*D+d*R+m*O+g*C,r[15]=i*D+c*R+p*O+v*C,r}function m(e,t,r,o,a){var n=Math.tan;a=a||new Le(16);var i=n(.5*he-.5*e),s=1/(r-o);return a[0]=i/t,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=i,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=(r+o)*s,a[11]=-1,a[12]=0,a[13]=0,a[14]=2*(r*o*s),a[15]=0,a}function p(e,o,n,i){return i=i||new Le(16),ve=ve||t(),xe=xe||t(),be=be||t(),l(r(e,o,be),be),l(a(n,be,ve),ve),l(a(be,ve,xe),xe),i[0]=ve[0],i[1]=ve[1],i[2]=ve[2],i[3]=0,i[4]=xe[0],i[5]=xe[1],i[6]=xe[2],i[7]=0,i[8]=be[0],i[9]=be[1],i[10]=be[2],i[11]=0,i[12]=e[0],i[13]=e[1],i[14]=e[2],i[15]=1,i}function y(e,t){return t=t||new Le(16),t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function h(e,t){t=t||new Le(16);var r=ye(e),o=pe(e);return t[0]=r,t[1]=0,t[2]=-o,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=o,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function g(e,t,r,o){o=o||new Le(16);var a=t[0],i=t[1],l=t[2],d=ge(a*a+i*i+l*l);a/=d,i/=d,l/=d;var n=a*a,u=i*i,f=l*l,m=ye(r),c=pe(r),s=1-m,p=n+(1-n)*m,h=a*i*s+l*c,g=a*l*s-i*c,v=a*i*s-l*c,b=u+(1-u)*m,_=i*l*s+a*c,T=a*l*s+i*c,E=i*l*s-a*c,L=f+(1-f)*m,S=e[0],A=e[1],w=e[2],P=e[3],M=e[4],D=e[5],R=e[6],O=e[7],C=e[8],B=e[9],F=e[10],G=e[11];return o[0]=p*S+h*M+g*C,o[1]=p*A+h*D+g*B,o[2]=p*w+h*R+g*F,o[3]=p*P+h*O+g*G,o[4]=v*S+b*M+_*C,o[5]=v*A+b*D+_*B,o[6]=v*w+b*R+_*F,o[7]=v*P+b*O+_*G,o[8]=T*S+E*M+L*C,o[9]=T*A+E*D+L*B,o[10]=T*w+E*R+L*F,o[11]=T*P+E*O+L*G,e!==o&&(o[12]=e[12],o[13]=e[13],o[14]=e[14],o[15]=e[15]),o}function v(e,t){return t=t||new Le(16),t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function x(e,r,o){o=o||t();var a=r[0],n=r[1],i=r[2],s=a*e[3]+n*e[7]+i*e[11]+e[15];return o[0]=(a*e[0]+n*e[4]+i*e[8]+e[12])/s,o[1]=(a*e[1]+n*e[5]+i*e[9]+e[13])/s,o[2]=(a*e[2]+n*e[6]+i*e[10]+e[14])/s,o}function b(e,r,o){o=o||t();var a=r[0],n=r[1],i=r[2];return o[0]=a*e[0]+n*e[4]+i*e[8],o[1]=a*e[1]+n*e[5]+i*e[9],o[2]=a*e[2]+n*e[6]+i*e[10],o}function _(e,t){t=t||new Le(16);var r=e[0],o=e[1],a=e[2],n=e[3],i=r+r,s=o+o,l=a+a,d=r*i,c=r*s,u=r*l,f=o*s,m=o*l,p=a*l,y=n*i,h=n*s,g=n*l;return t[0]=1-(f+p),t[1]=c+g,t[2]=u-h,t[3]=0,t[4]=c-g,t[5]=1-(d+p),t[6]=m+y,t[7]=0,t[8]=u+h,t[9]=m-y,t[10]=1-(d+f),t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function T(e,t){e=e.replace(/^data:\S+base64,/,"").replace(/=+$/,"");for(var r,o,a,n,i=e.length,s=t||.75*e.length,l=0,d=new ArrayBuffer(s),c=new Uint8Array(d),u=0;u<i;u+=4)r=Ae[e.charCodeAt(u)],o=Ae[e.charCodeAt(u+1)],a=Ae[e.charCodeAt(u+2)],n=Ae[e.charCodeAt(u+3)],c[l++]=r<<2|o>>4,c[l++]=(15&o)<<4|a>>2,c[l++]=(3&a)<<6|63&n;return d}function E(e){for(var t=new Uint8Array(e),r=t.length,o="",a=0;a<r;a+=3)o+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[t[a]>>2],o+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(3&t[a])<<4|t[a+1]>>4],o+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(15&t[a+1])<<2|t[a+2]>>6],o+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[63&t[a+2]];return 2==r%3?o=o.substring(0,o.length-1)+"=":1==r%3&&(o=o.substring(0,o.length-2)+"=="),o}function L(e,t,r){if(!e)throw new Error("canvas not exist");var o=e.getBoundingClientRect();return{x:(t-o.left)*(e.width/o.width),y:(r-o.top)*(e.height/o.height)}}function S(e,t){var r=Math.floor;t=t||window.devicePixelRatio;var o=e.width,a=e.height,n=r(e.clientWidth*t),i=r(e.clientHeight*t);(o!==n||a!==i)&&(e.width=n,e.height=i,e.style.width=o+"px",e.style.height=a+"px")}function A(e,t){var r="mousewheel";try{document.createEvent("MouseScrollEvents"),r="DOMMouseScroll"}catch(t){}e.addEventListener(r,function(r){if("wheelDelta"in r){var e=r.wheelDelta;window.opera&&10>opera.version()&&(e=-e),r.delta=me(e)/120}else"detail"in r&&(r.wheelDelta=40*-r.detail,r.delta=r.wheelDelta/120);t(r)},!1)}function w(t){function r(r){var e=Math.acos,o=L(t,r.clientX,r.clientY),a=2*((_.y>v.y?_.x-o.x:o.x-_.x)/m*he),i=(_.y-o.y)/p*he,s=S[1],c=e(n(l(S),l([0,s,0]))),u=h(a);c+i<he/90&&0<s&&0>i&&(i=he/180-c),c-i<he/90&&0>s&&0<i&&(i=c-he/180);var f=b(h(-he/2),[S[0],0,S[2]]),y=g(u,f,-i);E=d(x(y,S))}function a(){S=d(E),t.removeEventListener("mouseup",a,!1),t.removeEventListener("mousemove",r,!1),t.removeEventListener("mouseout",a,!1)}var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[0,5,5],c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,u=3<arguments.length&&void 0!==arguments[3]?arguments[3]:50;if(!t)throw new Error("canvas not exist");var f,m=t.clientWidth,p=t.clientHeight,v={x:m/2,y:p/2},_=v,T=1,E=i,S=i;return A(t,function(t){var e=s(S);e<c+1&&0>t.delta||e>u-1&&0<t.delta||(T+=.05*t.delta,E=o(S,T),clearTimeout(f),f=setTimeout(function(){T=1,S=d(E)},20))}),t.addEventListener("mousedown",function(o){_=L(t,o.clientX,o.clientY),t.addEventListener("mousemove",r,!1),t.addEventListener("mouseup",a,!1),t.addEventListener("mouseout",a,!1)},!1),function(){return E}}function z(e){var t=e.url,r=e.onLoad;if(!t)throw new Error("url not exist");if(!r||"function"!=typeof r)throw new Error("require callback onLoad");-1<t.search(/\.glb/i)?(e.type="arraybuffer",e.succ=function(t){var r=new Uint32Array(t,0,3);if(r[0]!=1179937895)throw new Error("not Binary glTF");var o=r[2];console.log("version: ".concat(r[1]," length: ").concat(o));for(var a=[],n={},i=12;i<o;){var s=new Uint32Array(t,i,2),l=s[0],d=s[1];i+=8;var c=t.slice(i,i+l);if(i+=l,d==1313821514){var u=new TextDecoder().decode(c);n=JSON.parse(u)}else d==5130562&&a.push(c)}n.arrayBuffers=a,R(n,e)}):e.succ=function(t){R(t,e)},P(e)}function P(e){var t={url:"",type:"json",succ:function(){},onProgress:function(){},onError:function(){}};for(var r in e)e[r]&&(t[r]=e[r]);if(!t.url)throw new Error("url is empty");var o=new XMLHttpRequest;o.responseType=t.type,o.open("GET",t.url,!0),o.addEventListener("load",function(e){200===this.status||0===this.status?(0===this.status&&console.warn("FileLoader: HTTP Status 0 received."),t.succ(this.response)):t.onError(e)},!1),o.addEventListener("progress",t.onProgress,!1),o.addEventListener("error",t.onError,!1),o.addEventListener("abort",t.onError,!1),o.send(null)}function M(e){var t=Ce[e];return t?t:Oe.test(e)?Ce.TEXCOORD:""}function D(e){var t=Be[e];return t?t:Oe.test(e)?Be.TEXCOORD:0}function R(e,t){function r(){console.time("GLTFLoader"),e.extensionsUsed&&e.extensionsUsed.some(function(e){return"KHR_draco_mesh_compression"==e})?DracoDecoderModule().then(function(t){u=t,f=new t.Decoder,e.scenes.forEach(function(t){t.nodes.forEach(function(t){o(e.nodes[t],[])})}),t.destroy(f),l(n)}):(e.scenes.forEach(function(t){t.nodes.forEach(function(t){a(e.nodes[t],[])})}),l(n)),console.timeEnd("GLTFLoader")}function o(t,r){var a=r.slice();a.push(t);var i=t.mesh;void 0!==i&&e.meshes[i].primitives.forEach(function(t){var r=t.extensions.KHR_draco_mesh_compression,o=e.bufferViews[r.bufferView],i=new u.DecoderBuffer;i.Init(new Int8Array(e.arrayBuffers[o.buffer],o.byteOffset,o.byteLength),o.byteLength);var s,l,d=f.GetEncodedGeometryType(i);if(d===u.TRIANGULAR_MESH)s=new u.Mesh,l=f.DecodeBufferToMesh(i,s);else if(d===u.POINT_CLOUD)s=new u.PointCloud,l=f.DecodeBufferToPointCloud(i,s);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!l.ok()||0===s.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+l.error_msg());var c={};if(Object.keys(r.attributes).forEach(function(e){if(!De.test(e))return!0;var t,o;if(Re.test(e))t=r.attributes[e],o=f.GetAttributeByUniqueId(s,t);else{if(t=f.GetAttributeId(s,u.TEX_COORD),-1===t)return!0;o=f.GetAttribute(s,t)}c[M(e)]=F(u,f,s,o,e)}),d===u.TRIANGULAR_MESH){var m=s.num_faces(),p=3*m,y=4*p,h=u._malloc(y);f.GetTrianglesUInt32Array(s,y,h);var g=new Uint32Array(u.HEAPU32.buffer,h,p).slice();c.indices={data:g,type:5125,size:1,count:g.length},u._free(h)}var v={attributes:c,nodes:a};C(e,v,t),n.push(v),u.destroy(s),u.destroy(i)}),t.children&&t.children.forEach(function(t){o(e.nodes[t],a)})}function a(t,r){var o=r.slice();o.push(t),O(e,t);var i=t.mesh;void 0!==i&&e.meshes[i].primitives.forEach(function(t){var r={};if(Object.keys(t.attributes).forEach(function(o){if(!De.test(o))return!0;var a=t.attributes[o],n=e.accessors[a].bufferView,i=e.bufferViews[n],s=new Float32Array(e.arrayBuffers[i.buffer],i.byteOffset,i.byteLength/Float32Array.BYTES_PER_ELEMENT);r[M(o)]={data:s,type:5126,size:D(o),count:s.length}}),void 0!==t.indices){var a=e.accessors[t.indices].bufferView,i=e.bufferViews[a],s=new Uint16Array(e.arrayBuffers[i.buffer],i.byteOffset,i.byteLength/Uint16Array.BYTES_PER_ELEMENT);r.indices={data:s,type:5123,size:1,count:s.length}}var l={attributes:r,nodes:o};C(e,l,t),n.push(l)}),t.children&&t.children.forEach(function(t){a(e.nodes[t],o)})}var n=[],i=t.url,s=t.onProgress,l=t.onLoad,d=i.lastIndexOf("/");if(e.baseURL=0<=d?i.substr(0,d+1):"",e.arrayBuffers=e.arrayBuffers||[],e.arrayBuffers.length)r();else if(-1<e.buffers[0].uri.search(/^data:\S+;base64/))e.buffers.forEach(function(t){e.arrayBuffers.push(T(t.uri,t.byteLength))}),r();else{var c=0;e.buffers.forEach(function(t,o){P({url:e.baseURL+t.uri,type:"arraybuffer",onProgress:function(r){s(r,t.byteLength)},succ:function(t){c++,e.arrayBuffers[o]=t,c>=e.buffers.length&&r()}})})}var u,f}function O(e,t){if(t.extensions&&t.extensions.KHR_lights_punctual)t.extensions.KHR_lights_punctual.light;t.camera}function C(e,t,r){var o=e.materials[r.material];o.pbrMetallicRoughness.baseColorFactor&&(t.color=o.pbrMetallicRoughness.baseColorFactor);var a=me(100*(o.pbrMetallicRoughness.roughnessFactor||0)),n=100-a;if(t.shininess=900*(n*n)/1e4,o.pbrMetallicRoughness.baseColorTexture){t.map={src:""},B(e,o.pbrMetallicRoughness.baseColorTexture.index,t.map);var s=o.pbrMetallicRoughness.baseColorTexture.extensions;if(s&&s.KHR_texture_transform){t.textureTransform=s.KHR_texture_transform;var l=t.attributes.texcoord,d=s.KHR_texture_transform.scale;if(d&&l)for(var c=d[0],u=d[1],f=0;f<l.count;f+=2)l.data[f]*=c,l.data[f+1]*=u}}if(o.normalTexture){t.normalMap={src:""},B(e,o.normalTexture.index,t.normalMap);var m=o.normalTexture.extensions;m&&m.KHR_texture_transform&&(t.norTextureTransform=m.KHR_texture_transform)}}function B(e,t,r){var o=e.images[e.textures[t].source];if(o.uri)r.src=e.baseURL+o.uri;else if(o.bufferView!==void 0){var a=e.bufferViews[o.bufferView];r.src="data:".concat(o.mimeType,";base64,")+E(new Uint8Array(e.arrayBuffers[a.buffer],a.byteOffset,a.byteLength/Uint8Array.BYTES_PER_ELEMENT))}}function F(e,t,r,o,a){var n=o.num_components(),i=r.num_points(),s=i*n,l=4*s,d=e._malloc(l);t.GetAttributeDataArrayForAllPoints(r,o,e.DT_FLOAT32,l,d);var c=new Float32Array(e.HEAPF32.buffer,d,s).slice();return e._free(d),{data:c,type:5126,size:D(a),count:s}}function G(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function H(e,r){return Me||(Me=e.createTexture()),r instanceof Me.constructor}function I(e){return!!e.texStorage2D}function N(e){var t=e.name;return t.startsWith("gl_")||t.startsWith("webgl_")}function k(e,t){Et(e,0);var r=e.getExtension(t);if(r){var o={},a=Lt.exec(t)[1];for(var n in r){var i=r[n],s="function"==typeof i,l=s?a:"_"+a,d=n;n.endsWith(l)&&(d=n.substring(0,n.length-l.length)),e[d]===void 0?s?e[d]=function(e){return function(){return e.apply(r,arguments)}}(i):(e[d]=i,o[d]=i):!s&&e[d]!==i&&console.warn(d,e[d],i,n)}o.constructor={name:r.constructor.name},Et(o,0)}return r}function V(e){for(var t=0;t<Tt.length;t++)k(e,Tt[t])}function X(e){for(var t=arguments.length,r=Array(1<t?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];var a=U(r);return W(e,a)}function U(){for(var e,t,r,o,a=[],n=arguments.length,i=Array(n),s=0;s<n;s++)i[s]=arguments[s];(i+"").replace(/[^\,\s]+/g,function(e){e&&a.push(e)});for(var l,d=0,c=a;d<c.length;d++){if(l=c[d],r=document.getElementById(l),!r)throw new Error("Can't find script element "+l);if(o=r.type,!o)throw new Error("Script element type undefined");0<=o.indexOf("vert")&&(e=r.text),0<=o.indexOf("frag")&&(t=r.text)}if(!e)throw new Error("VERTEX_SHADER String not exist");if(!t)throw new Error("FRAGMENT_SHADER String not exist");return[e,t]}function W(e){for(var t=arguments.length,r=Array(1<t?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];Array.isArray(r[0])&&(r=r[0]);var a=Y(e,35633,r[0]),n=Y(e,35632,r[1]);if(!a)throw new Error("VERTEX_SHADER not exist");if(!n)throw new Error("FRAGMENT_SHADER not exist");var i=e.createProgram();if(!i)throw new Error("Program not exist");e.attachShader(i,a),e.attachShader(i,n),e.linkProgram(i);var s=e.getProgramParameter(i,35714);if(!s){var l=e.getProgramInfoLog(i);throw e.deleteProgram(i),e.deleteShader(n),e.deleteShader(a),new Error("Failed to link program: "+l.toString())}return i}function Y(e,t,r){var o=e.createShader(t);if(!o)throw new Error("Unable to create shader");e.shaderSource(o,r),e.compileShader(o);var a=e.getShaderParameter(o,35713);if(!a){var n=e.getShaderInfoLog(o);throw e.deleteShader(o),new Error("Failed to compile shader: "+n.toString())}return o}function j(e){for(var t=arguments.length,r=Array(1<t?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];Array.isArray(r[0])&&(r=r[0]);var a=0<r[0].indexOf("{")?W(e,r):X(e,r),n=q(e,a),i=K(e,a);return{program:a,uniformSetters:n,attribSetters:i}}function K(e,t){for(var r,o={},a=e.getProgramParameter(t,35721),n=0;n<a;n++)if(r=e.getActiveAttrib(t,n),!N(r)){var s=e.getAttribLocation(t,r.name),l=gt[r.type],d=l.setter(e,s,l);d.location=s,o[r.name]=d}return o}function q(e,t){function r(t,r){var o=e.getUniformLocation(t,r.name),n=1<r.size&&"[0]"===r.name.substr(-3),i=r.type,s=ft[i];if(!s)throw new Error("unknown type: 0x"+i.toString(16));var l;if(s.bindPoint){var d=a;a+=r.size,l=n?s.arraySetter(e,i,d,o,r.size):s.setter(e,i,d,o,r.size)}else l=s.arraySetter&&n?s.arraySetter(e,o):s.setter(e,o);return l.location=o,l}for(var o,a=0,n={},s=e.getProgramParameter(t,35718),l=0;l<s;l++)if(o=e.getActiveUniform(t,l),!N(o)){var d=o.name;"[0]"===d.substr(-3)&&(d=d.substr(0,d.length-3));var c=r(t,o);n[d]=c}return n}function J(e,t){for(var r in e=e.uniformSetters||e,t){var o=e[r];o&&o(t[r])}}function Q(e,t,r){t.vertexArrayObject?e.bindVertexArray(t.vertexArrayObject):(Z(r.attribSetters||r,t.attribs),t.indices&&e.bindBuffer(34963,t.indices))}function Z(e,t){for(var r in e=e.attribSetters||e,t){var o=e[r];o&&o(t[r])}}function $(e,t){var r={attribs:ee(e,t)},o=t.indices;if(o){var a=ne(o,Uint16Array);r.indices=te(e,a,34963),r.count=o.count||a.length,r.indexType=o.type||5123}else r.count=ae(t);return r}function ee(e,t){var r={};for(var o in t)if(!bt(o)){var a=t[o],n=ne(a),i=a.name||a.attrName||xt(o);r[i]={buffer:te(e,n,void 0,a.drawType),size:a.size||oe(i),type:a.type,normalize:ie(n),stride:a.stride||0,offset:a.offset||0,divisor:a.divisor,drawType:a.drawType||35044}}return e.bindBuffer(34962,null),r}function te(e,t,r,o){r=r||34962;var a=e.createBuffer();return e.bindBuffer(r,a),e.bufferData(r,t,o||35044),a}function re(e,t,r){var o=e.createVertexArray();return e.bindVertexArray(o),t.length||(t=[t]),t.forEach(function(t){Q(e,r,t)}),e.bindVertexArray(null),{count:r.count,indexType:r.indexType,vertexArrayObject:o}}function oe(e,t){var r;if(r=St.test(e)?2:At.test(e)?4:3,0<t%r)throw new Error("Can not guess size for attribute ".concat(e,". Tried ").concat(r," but ").concat(t," values is not evenly divisible by ").concat(r,". You should specify it."));return r}function ae(e){for(var t,r=Object.keys(e),o=r[0],a=0,n=r;a<n.length;a++)if(t=n[a],wt.test(t)){o=t;break}var i=e[o],s=i.count||(i.data?i.data:i).length,l=i.size||oe(o,s);if(0<s%l)throw new Error("numComponents ".concat(l," not correct for length ").concat(s));return s/l}function ne(e,t){if(_t(e))return e;if(_t(e.data))return e.data;Array.isArray(e)&&(e={data:e});var r=e.type||t||Float32Array;return new r(e.data)}function ie(e){return!!(e instanceof Int8Array)||!!(e instanceof Uint8Array)}function se(e,t,r,o,a){r=r||4,o=o||t.count,a=a||0;var n=t.indexType;n?e.drawElements(r,o,n,a):e.drawArrays(r,a,o)}function le(e,t,r,o){var a=e.createTexture();if(!a)throw new Error("Failed to create texture object");var n=t.target||3553,i=t.format||6408,s=t.informat||i,l=t.type||5121;return e.bindTexture(n,a),r&&o&&e.texImage2D(n,0,s,r,o,0,i,l,null),e.texParameteri(n,10241,t.min||9729),e.texParameteri(n,10240,t.mag||9729),e.texParameteri(n,10243,t.wrapT||10497),e.texParameteri(n,10242,t.wrapS||10497),a}function de(e,t,r){function o(r,o,d){e.texImage2D(o,0,6408,1,1,0,6408,5121,new Uint8Array([0,0,255,255]));var c=new Image;c.onload=function(){!t.flipY||e.pixelStorei(37440,1),e.bindTexture(a,l),e.texImage2D(o,0,i,n,s,c),d&&d()},-1<r.search(/^data:image/)?c.src=r:ce(c,r)}var a=t.target||3553,n=t.format||6408,i=t.informat||n,s=t.type||5121,l=le(e,t),d=t.src;if("string"==typeof d){if(3553!=a)throw new Error("the target must be gl.TEXTURE_2D");o(t.src,a,function(){e.generateMipmap(a),e.bindTexture(a,null),r&&r(l)})}else if(Array.isArray(d)&&6===d.length&&"string"==typeof d[0]){if(34067!=a)throw new Error("the target must be gl.TEXTURE_CUBE_MAP");var c=d.length;d.forEach(function(t,n){o(t,34069+n,function(){c--,0>=c&&(e.generateMipmap(a),e.bindTexture(a,null),r&&r(l))})})}return e.bindTexture(a,null),l}function ce(e,t){var r=location.href.lastIndexOf("/")+1;0>t.search("http")&&(t=location.href.substr(0,r)+t),new URL(t).origin!==window.location.origin&&(e.crossOrigin=""),e.src=t}function ue(){var e=function(e,t){if(t=t||e.total,t){var r=100*(e.loaded/t);Mt.innerHTML=me(r,2)+"% downloaded"}};return new Promise(function(t,r){z({url:"/model/room2.glb",onLoad:function(e){t(e),Mt.style.display="none"},onProgress:e,onError:r})})}function fe(){zt.addEventListener("mousedown",function(){Ct=!1},!1)}for(var ve,xe,be,_e=e(function(e){var t=function(e){function t(e,t,r,a){var n=t&&t.prototype instanceof o?t:o,i=Object.create(n.prototype),s=new f(a||[]);return i._invoke=l(e,r,s),i}function r(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}function o(){}function a(){}function n(){}function i(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function s(e){function t(o,a,n,i){var s=r(e[o],e,a);if("throw"===s.type)i(s.arg);else{var l=s.arg,d=l.value;return d&&"object"==typeof d&&g.call(d,"__await")?Promise.resolve(d.__await).then(function(e){t("next",e,n,i)},function(e){t("throw",e,n,i)}):Promise.resolve(d).then(function(e){l.value=e,n(l)},function(e){return t("throw",e,n,i)})}}function o(e,r){function o(){return new Promise(function(o,a){t(e,r,o,a)})}return a=a?a.then(o,o):o()}var a;this._invoke=o}function l(e,t,o){var a="suspendedStart";return function(n,i){if("executing"===a)throw new Error("Generator is already running");if("completed"===a){if("throw"===n)throw i;return p()}for(o.method=n,o.arg=i;;){var s=o.delegate;if(s){var l=d(s,o);if(l){if(l===T)continue;return l}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if("suspendedStart"===a)throw a="completed",o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);a="executing";var c=r(e,t,o);if("normal"===c.type){if(a=o.done?"completed":"suspendedYield",c.arg===T)continue;return{value:c.arg,done:o.done}}"throw"===c.type&&(a="completed",o.method="throw",o.arg=c.arg)}}}function d(e,t){var o=e.iterator[t.method];if(o===y){if(t.delegate=null,"throw"===t.method){if(e.iterator["return"]&&(t.method="return",t.arg=y,d(e,t),"throw"===t.method))return T;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return T}var a=r(o,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,T;var n=a.arg;if(!n)return t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,T;if(n.done)t[e.resultName]=n.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=y);else return n;return t.delegate=null,T}function c(e){var t={tryLoc:e[0]};(1 in e)&&(t.catchLoc=e[1]),(2 in e)&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function u(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function f(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(c,this),this.reset(!0)}function m(e){if(e){var t=e[x];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(g.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=y,t.done=!0,t};return o.next=o}}return{next:p}}function p(){return{value:y,done:!0}}var y,h=Object.prototype,g=h.hasOwnProperty,v="function"==typeof Symbol?Symbol:{},x=v.iterator||"@@iterator",b=v.asyncIterator||"@@asyncIterator",_=v.toStringTag||"@@toStringTag";e.wrap=t;var T={},E={};E[x]=function(){return this};var L=Object.getPrototypeOf,S=L&&L(L(m([])));S&&S!==h&&g.call(S,x)&&(E=S);var A=n.prototype=o.prototype=Object.create(E);return a.prototype=A.constructor=n,n.constructor=a,n[_]=a.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===a||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,n):(e.__proto__=n,!(_ in e)&&(e[_]="GeneratorFunction")),e.prototype=Object.create(A),e},e.awrap=function(e){return{__await:e}},i(s.prototype),s.prototype[b]=function(){return this},e.AsyncIterator=s,e.async=function(r,o,a,n){var i=new s(t(r,o,a,n));return e.isGeneratorFunction(o)?i:i.next().then(function(e){return e.done?e.value:i.next()})},i(A),A[_]="Generator",A[x]=function(){return this},A.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var o=t.pop();if((o in e))return r.value=o,r.done=!1,r}return r.done=!0,r}},e.values=m,f.prototype={constructor:f,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=y,this.done=!1,this.delegate=null,this.method="next",this.arg=y,this.tryEntries.forEach(u),!e)for(var t in this)"t"===t.charAt(0)&&g.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=y)},stop:function(){this.done=!0;var e=this.tryEntries[0],t=e.completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){function t(t,o){return n.type="throw",n.arg=e,r.next=t,o&&(r.method="next",r.arg=y),!!o}if(this.done)throw e;for(var r=this,o=this.tryEntries.length-1;0<=o;--o){var a=this.tryEntries[o],n=a.completion;if("root"===a.tryLoc)return t("end");if(a.tryLoc<=this.prev){var s=g.call(a,"catchLoc"),l=g.call(a,"finallyLoc");if(s&&l){if(this.prev<a.catchLoc)return t(a.catchLoc,!0);if(this.prev<a.finallyLoc)return t(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return t(a.catchLoc,!0);}else if(!l)throw new Error("try statement without catch or finally");else if(this.prev<a.finallyLoc)return t(a.finallyLoc)}}},abrupt:function(e,t){for(var r,o=this.tryEntries.length-1;0<=o;--o)if(r=this.tryEntries[o],r.tryLoc<=this.prev&&g.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var n=a?a.completion:{};return n.type=e,n.arg=t,a?(this.method="next",this.next=a.finallyLoc,T):this.complete(n)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),T},finish:function(e){for(var t,r=this.tryEntries.length-1;0<=r;--r)if(t=this.tryEntries[r],t.finallyLoc===e)return this.complete(t.completion,t.afterLoc),u(t),T},catch:function(e){for(var t,r=this.tryEntries.length-1;0<=r;--r)if(t=this.tryEntries[r],t.tryLoc===e){var o=t.completion;if("throw"===o.type){var a=o.arg;u(t)}return a}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:m(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=y),T}},e}(e.exports);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}}),Te=_e,Ee=Float32Array,Le=Float32Array,Se="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ae=new Uint8Array(256),we=0;we<Se.length;we++)Ae[Se.charCodeAt(we)]=we;var ze,Pe,Me,De=/POSITION|NORMAL|COLOR|TEXCOORD|TEX_COORD/,Re=/POSITION|NORMAL|COLOR|TEX_COORD/,Oe=/COORD/,Ce={POSITION:"position",NORMAL:"normal",COLOR:"color",TEXCOORD:"texcoord"},Be={POSITION:3,NORMAL:3,COLOR:3,TEXCOORD:2},Fe=G,Ge=33984,He=34962,Ie=5126,Ne=35664,ke=35665,Ve=35666,Xe=5124,Ue=35667,We=35668,Ye=35669,je=35670,Ke=35671,qe=35672,Je=35673,Qe=35674,Ze=35675,$e=35676,et=5125,tt=36294,rt=36295,ot=36296,at=function(e,t){return function(r){e.uniform1i(t,r)}},nt=function(e,t){return function(r){e.uniform1iv(t,r)}},it=function(e,t){return function(r){e.uniform2iv(t,r)}},st=function(e,t){return function(r){e.uniform3iv(t,r)}},lt=function(e,t){return function(r){e.uniform4iv(t,r)}},dt=function(e){return ft[e].bindPoint},ct=function(e,t,r,o){var a=dt(t);return I(e)?function(t){var n,i;H(e,t)?(n=t,i=null):(n=t.texture,i=t.sampler),e.uniform1i(o,r),e.activeTexture(Ge+r),e.bindTexture(a,n),e.bindSampler(r,i)}:function(t){e.uniform1i(o,r),e.activeTexture(Ge+r),e.bindTexture(a,t)}},ut=function(e,t,r,o,a){for(var n=dt(t),s=new Int32Array(a),l=0;l<a;l++)s[l]=r+l;return I(e)?function(t){e.uniform1iv(o,s),t.forEach(function(t,o){e.activeTexture(Ge+s[o]);var a,i;H(e,t)?(a=t,i=null):(a=t.texture,i=t.sampler),e.bindSampler(r,i),e.bindTexture(n,a)})}:function(t){e.uniform1iv(o,s),t.forEach(function(t,r){e.activeTexture(Ge+s[r]),e.bindTexture(n,t)})}},ft=(ze={},Fe(ze,Ie,{Type:Float32Array,size:4,setter:function(e,t){return function(r){e.uniform1f(t,r)}},arraySetter:function(e,t){return function(r){e.uniform1fv(t,r)}}}),Fe(ze,Ne,{Type:Float32Array,size:8,setter:function(e,t){return function(r){e.uniform2fv(t,r)}}}),Fe(ze,ke,{Type:Float32Array,size:12,setter:function(e,t){return function(r){e.uniform3fv(t,r)}}}),Fe(ze,Ve,{Type:Float32Array,size:16,setter:function(e,t){return function(r){e.uniform4fv(t,r)}}}),Fe(ze,Xe,{Type:Int32Array,size:4,setter:at,arraySetter:nt}),Fe(ze,Ue,{Type:Int32Array,size:8,setter:it}),Fe(ze,We,{Type:Int32Array,size:12,setter:st}),Fe(ze,Ye,{Type:Int32Array,size:16,setter:lt}),Fe(ze,et,{Type:Uint32Array,size:4,setter:function(e,t){return function(r){e.uniform1ui(t,r)}},arraySetter:function(e,t){return function(r){e.uniform1uiv(t,r)}}}),Fe(ze,tt,{Type:Uint32Array,size:8,setter:function(e,t){return function(r){e.uniform2uiv(t,r)}}}),Fe(ze,rt,{Type:Uint32Array,size:12,setter:function(e,t){return function(r){e.uniform3uiv(t,r)}}}),Fe(ze,ot,{Type:Uint32Array,size:16,setter:function(e,t){return function(r){e.uniform4uiv(t,r)}}}),Fe(ze,je,{Type:Uint32Array,size:4,setter:at,arraySetter:nt}),Fe(ze,Ke,{Type:Uint32Array,size:8,setter:it}),Fe(ze,qe,{Type:Uint32Array,size:12,setter:st}),Fe(ze,Je,{Type:Uint32Array,size:16,setter:lt}),Fe(ze,Qe,{Type:Float32Array,size:16,setter:function(e,t){return function(r){e.uniformMatrix2fv(t,!1,r)}}}),Fe(ze,Ze,{Type:Float32Array,size:36,setter:function(e,t){return function(r){e.uniformMatrix3fv(t,!1,r)}}}),Fe(ze,$e,{Type:Float32Array,size:64,setter:function(e,t){return function(r){e.uniformMatrix4fv(t,!1,r)}}}),Fe(ze,35685,{Type:Float32Array,size:24,setter:function(e,t){return function(r){e.uniformMatrix2x3fv(t,!1,r)}}}),Fe(ze,35686,{Type:Float32Array,size:32,setter:function(e,t){return function(r){e.uniformMatrix2x4fv(t,!1,r)}}}),Fe(ze,35687,{Type:Float32Array,size:24,setter:function(e,t){return function(r){e.uniformMatrix3x2fv(t,!1,r)}}}),Fe(ze,35688,{Type:Float32Array,size:48,setter:function(e,t){return function(r){e.uniformMatrix3x4fv(t,!1,r)}}}),Fe(ze,35689,{Type:Float32Array,size:32,setter:function(e,t){return function(r){e.uniformMatrix4x2fv(t,!1,r)}}}),Fe(ze,35690,{Type:Float32Array,size:48,setter:function(e,t){return function(r){e.uniformMatrix4x3fv(t,!1,r)}}}),Fe(ze,35678,{Type:null,size:0,setter:ct,arraySetter:ut,bindPoint:3553}),Fe(ze,35680,{Type:null,size:0,setter:ct,arraySetter:ut,bindPoint:34067}),Fe(ze,35679,{Type:null,size:0,setter:ct,arraySetter:ut,bindPoint:32879}),Fe(ze,36289,{Type:null,size:0,setter:ct,arraySetter:ut,bindPoint:35866}),ze),mt=function(e,t){return function(r){if(r.value)switch(e.disableVertexAttribArray(t),r.value.length){case 4:e.vertexAttrib4fv(t,r.value);break;case 3:e.vertexAttrib3fv(t,r.value);break;case 2:e.vertexAttrib2fv(t,r.value);break;case 1:e.vertexAttrib1fv(t,r.value);break;default:throw new Error("the length of a float constant value must be between 1 and 4!");}else e.bindBuffer(He,r.buffer),e.enableVertexAttribArray(t),e.vertexAttribPointer(t,r.size,r.type||Ie,r.normalize||!1,r.stride||0,r.offset||0),void 0!==r.divisor&&e.vertexAttribDivisor(t,r.divisor)}},pt=function(e,t){return function(r){if(!r.value)e.bindBuffer(He,r.buffer),e.enableVertexAttribArray(t),e.vertexAttribIPointer(t,r.size,r.type||Xe,r.stride||0,r.offset||0),void 0!==r.divisor&&e.vertexAttribDivisor(t,r.divisor);else if(e.disableVertexAttribArray(t),4===r.value.length)e.vertexAttrib4iv(t,r.value);else throw new Error("The length of an integer constant value must be 4!")}},yt=function(e,t){return function(r){if(!r.value)e.bindBuffer(He,r.buffer),e.enableVertexAttribArray(t),e.vertexAttribIPointer(t,r.size,r.type||et,r.stride||0,r.offset||0),void 0!==r.divisor&&e.vertexAttribDivisor(t,r.divisor);else if(e.disableVertexAttribArray(t),4===r.value.length)e.vertexAttrib4uiv(t,r.value);else throw new Error("The length of an unsigned integer constant value must be 4!")}},ht=function(e,t,r){return function(o){var a=o.count||r.size,n=r.count;e.bindBuffer(He,o.buffer);for(var s=o.type||Ie,l=ft[s].size*a,d=o.normalize||!1,c=o.offset||0,u=0;u<n;u++)e.enableVertexAttribArray(t+u),e.vertexAttribPointer(t+u,a/n,s,d,l,c+l/n*u),void 0!==o.divisor&&e.vertexAttribDivisor(t+u,o.divisor)}},gt=(Pe={},Fe(Pe,Ie,{size:4,setter:mt}),Fe(Pe,Ne,{size:8,setter:mt}),Fe(Pe,ke,{size:12,setter:mt}),Fe(Pe,Ve,{size:16,setter:mt}),Fe(Pe,Xe,{size:4,setter:pt}),Fe(Pe,Ue,{size:8,setter:pt}),Fe(Pe,We,{size:12,setter:pt}),Fe(Pe,Ye,{size:16,setter:pt}),Fe(Pe,et,{size:4,setter:yt}),Fe(Pe,tt,{size:8,setter:yt}),Fe(Pe,rt,{size:12,setter:yt}),Fe(Pe,ot,{size:16,setter:yt}),Fe(Pe,je,{size:4,setter:pt}),Fe(Pe,Ke,{size:8,setter:pt}),Fe(Pe,qe,{size:12,setter:pt}),Fe(Pe,Je,{size:16,setter:pt}),Fe(Pe,Qe,{size:4,setter:ht,count:2}),Fe(Pe,Ze,{size:9,setter:ht,count:3}),Fe(Pe,$e,{size:16,setter:ht,count:4}),Pe),vt={addExtensionsToContext:!0},xt=function(e){return"a"+e[0].toUpperCase()+e.substr(1)},bt=function(e){return"indices"===e},_t="undefined"==typeof SharedArrayBuffer?function(e){return e&&e.buffer&&e.buffer instanceof ArrayBuffer}:function(e){return e&&e.buffer&&(e.buffer instanceof ArrayBuffer||e.buffer instanceof SharedArrayBuffer)},Tt=["ANGLE_instanced_arrays","EXT_blend_minmax","EXT_color_buffer_float","EXT_color_buffer_half_float","EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2","EXT_frag_depth","EXT_sRGB","EXT_shader_texture_lod","EXT_texture_filter_anisotropic","OES_element_index_uint","OES_standard_derivatives","OES_texture_float","OES_texture_float_linear","OES_texture_half_float","OES_texture_half_float_linear","OES_vertex_array_object","WEBGL_color_buffer_float","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_depth_texture","WEBGL_draw_buffers"],Et=function(){function e(e){var o=e.constructor.name;if(!t[o]){for(var a in e)if("number"==typeof e[a]){var n=r[e[a]];r[e[a]]=n?"".concat(n," | ").concat(a):a}t[o]=!0}}var t={},r={};return function(t,o){return e(t),r[o]||"0x"+o.toString(16)}}(),Lt=/^(.*?)_/,St=/coord|texture/i,At=/color|colour/i,wt=/position/i,zt=document.getElementById("canvas"),Pt=function(e,t){for(var r,o=["webgl","experimental-webgl"],a=null,n=0,i=o;n<i.length;n++)if(r=i[n],a=e.getContext(r,t),a&&"webgl"===r){vt.addExtensionsToContext&&V(a);break}return a}(zt),Mt=document.getElementsByTagName("h3")[0],Dt=[0,6,9],Rt=[1,1,1],Ot=[.6,.6,.6],Ct=!0,Bt=[0,9,8];(function(){var e,t,r,o,a,n,i,s;return Te.async(function(l){for(;;)switch(l.prev=l.next){case 0:if(Pt){l.next=2;break}return l.abrupt("return");case 2:return fe(),e=j(Pt,"#define GLSLIFY 1\nattribute vec4 aPosition; \nattribute vec4 aNormal;//\u6CD5\u5411\u91CF\nattribute vec2 aTexcoord;//\u7EB9\u7406\u5750\u6807\nuniform mat4 vpMatrix;//vp\u77E9\u9635\nuniform mat4 modelMatrix;//\u6A21\u578B\u77E9\u9635\nvarying vec3 vNormal;//\u6CD5\u5411\u91CF\nvarying vec3 vPosition;\nvarying vec2 vTexcoord;\n\nvoid main() { \n\tvPosition = vec3(modelMatrix * aPosition);\n\tvTexcoord = aTexcoord;\n\tvNormal = vec3(modelMatrix * aNormal);\n\tgl_Position  = vpMatrix * modelMatrix * aPosition;\n}","#extension GL_OES_standard_derivatives : enable\nprecision highp float;\n#define GLSLIFY 1\nuniform vec3 viewPosition;\nuniform vec3 lightPosition;\nuniform vec3 lightColor;\nuniform vec3 ambientColor;\nuniform vec4 color;\nuniform vec3 specularColor;\nuniform float shininess;\nuniform bvec3 useMaps;\nuniform sampler2D diffMap;\nuniform sampler2D specMap;\nuniform sampler2D normMap;\nuniform float bumpScale;\nvarying vec3 vPosition;\nvarying vec2 vTexcoord;\nvarying vec3 vNormal;\nconst float constantAtt = 1.0;\nconst float linearAtt = 0.14;\nconst float quadraticAtt = 0.07;\nconst float gamma = 2.2;\nvec2 dHdxy_fwd_1540259130(sampler2D bumpMap, vec2 texcoord, float bump_scale) {\n\tvec2 dSTdx = dFdx(texcoord);\n\tvec2 dSTdy = dFdy(texcoord);\n\tfloat Hll = bump_scale * texture2D( bumpMap, texcoord ).x;\n\tfloat dBx = bump_scale * texture2D( bumpMap, texcoord + dSTdx ).x - Hll;\n\tfloat dBy = bump_scale * texture2D( bumpMap, texcoord + dSTdy ).x - Hll;\n\treturn vec2( dBx, dBy );\n}\nvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\tvec3 vN = surf_norm;\n\tvec3 R1 = cross( vSigmaY, vN );\n\tvec3 R2 = cross( vN, vSigmaX );\n\tfloat fDet = dot( vSigmaX, R1 );\n\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n}\nvec3 getNormal(sampler2D bumpMap, vec2 texcoord, vec3 surf_pos, vec3 surf_norm, float bump_scale){\n\treturn perturbNormalArb(-surf_pos, surf_norm, dHdxy_fwd_1540259130(bumpMap, texcoord, bump_scale));\n}\n\nvoid main() {\n\tvec3 normal = normalize(vNormal);\n\tif(useMaps.z){\n\t\tnormal = getNormal(normMap, vTexcoord, vPosition, normal, bumpScale);\n\t}\n\n\t// \u5149\u7EBF\u65B9\u5411\n\tvec3 lightDirection = normalize(lightPosition - vPosition);\n\t// \u5149\u7EBF\u65B9\u5411\u548C\u6CD5\u5411\u91CF\u5939\u89D2\n\tfloat nDotL = max(dot(lightDirection, normal), 0.0);\n\t// \u5149\u5F3A\u8870\u51CF\n\tfloat att = 0.0;\n\tif(nDotL > 0.0){\n\t\tfloat dis = length(lightPosition - vPosition);\n\t\tatt = 1.0/(constantAtt + linearAtt * dis + quadraticAtt * dis * dis);\n\t}\n\t\n\t// \u6F2B\u53CD\u5C04\u5149\u4EAE\u5EA6\n\tvec4 diffuseColor = !useMaps.x ? color : texture2D(diffMap, vTexcoord);\n\tvec3 diffuse = lightColor * nDotL * diffuseColor.rgb;\n\t// \u73AF\u5883\u5149\u4EAE\u5EA6\n\tvec3 ambient = ambientColor * diffuseColor.rgb;\n\n\t// \u89C2\u5BDF\u65B9\u5411\n\tvec3 eyeDirection = normalize(viewPosition - vPosition);\n\t// \u955C\u9762\u53CD\u5C04\n\tvec3 halfwayDir = normalize(lightDirection + eyeDirection);\n\tfloat specularIntensity = pow(max(dot(normal, halfwayDir), 0.0), shininess);\n\tvec3 specular = (!useMaps.y ? specularColor : texture2D(specMap, vTexcoord).rgb ) * specularIntensity;\n\t\n\t// vec3 mapped = pow(ambient + diffuse + specular, vec3(1.0 / gamma));\n\n\tgl_FragColor = vec4(ambient + diffuse + specular, diffuseColor.a);\n}"),l.next=6,Te.awrap(ue());case 6:t=l.sent,r=t.map(function(t){var r=c();t.nodes.forEach(function(e){var t=c(),o=c(),a=c();e.translation&&y(e.translation,t),e.rotation&&_(e.rotation,o),e.scale&&v(e.scale,a),f(r,f(f(t,o),a),r)}),t.matrix=r,t.map&&(t.diff=de(Pt,t.map)),t.normalMap&&(t.norm=de(Pt,t.normalMap));var o=$(Pt,t.attributes);return Object.assign(t,re(Pt,e,o)),t}),console.log(r),Pt.clearColor(0,0,0,1),Pt.enable(Pt.DEPTH_TEST),Pt.enable(Pt.CULL_FACE),S(zt),Pt.viewport(0,0,zt.width,zt.height),Pt.useProgram(e.program),o=c(),a=c(),n=m(he/6,zt.width/zt.height,1,50),i=w(zt,Bt,2,40),s=h(he/360),J(e,{lightPosition:Dt,lightColor:Rt,ambientColor:Ot,bumpScale:.5}),function t(){Ct?x(s,Bt,Bt):Bt=i(),p(Bt,[0,0,0],[0,1,0],a),f(n,u(a),o),J(e,{vpMatrix:o,viewPosition:Bt,specularColor:[1,1,1]}),Pt.clear(Pt.COLOR_BUFFER_BIT|Pt.DEPTH_BUFFER_BIT),r.forEach(function(t){var r={modelMatrix:t.matrix,color:t.color||[.5,.5,.5,1],useMaps:[!1,!1,!1],shininess:t.shininess};t.map&&(r.useMaps[0]=!0,r.diffMap=t.diff),t.normalMap&&(r.useMaps[2]=!0,r.normMap=t.norm),J(e,r),Q(Pt,t),se(Pt,t)}),Pt.bindVertexArray(null),requestAnimationFrame(t)}();case 22:case"end":return l.stop();}})})()})();
